<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Empleados</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- Script de Seguridad: Redirigir si no est√° logueado -->
    <script>
        // Esto se ejecuta ANTES de que la p√°gina cargue
        // Verifica si la informaci√≥n del usuario NO existe en sessionStorage
        if (!sessionStorage.getItem('usuarioLogueado')) {
            // Si no existe, redirige al login
            console.warn('Acceso denegado. Redirigiendo al login...');
            window.location.href = 'login.html';
        }
    </script>
</head>
<body>
<div class="container">
    <header>
        <div class="header-main">
            <h1>üßë‚Äçüíº Sistema de Gesti√≥n de Empleados</h1>
            <p class="subtitle">CRUD con Spring Boot y Axios (Lab 05)</p>
        </div>
        <div class="header-controls">
            <span>Bienvenido, <strong id="user-name">Usuario</strong></span>
            <button class="btn btn-secondary" id="btn-logout">
                Cerrar Sesi√≥n ‚ûî
            </button>
        </div>
    </header>

    <!-- Formulario para Crear/Editar Empleado -->
    <div class="card">
        <h2 id="form-title">‚ûï Agregar Nuevo Empleado</h2>
        <form id="empleado-form">
            <input type="hidden" id="empleado-id">

            <div class="form-row">
                <div class="form-group">
                    <label for="nombre">Nombre *</label>
                    <input type="text" id="nombre" placeholder="Ej: Ana" required minlength="3" maxlength="100">
                </div>
                <div class="form-group">
                    <label for="apellido">Apellido *</label>
                    <input type="text" id="apellido" placeholder="Ej: P√©rez" required minlength="3" maxlength="100">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" id="email" placeholder="Ej: ana.perez@empresa.com" required maxlength="150">
                </div>
                <div class="form-group">
                    <label for="telefono">Tel√©fono</label>
                    <input type="tel" id="telefono" placeholder="Ej: 999111222" maxlength="20">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="fechaContratacion">Fecha Contrataci√≥n *</label>
                    <input type="date" id="fechaContratacion" required>
                </div>
                <div class="form-group">
                    <label for="salario">Salario ($) *</label>
                    <input type="number" id="salario" placeholder="0.00" required min="0.01" step="0.01">
                </div>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label for="cargo">Cargo</label>
                    <input type="text" id="cargo" placeholder="Ej: Analista RRHH" maxlength="100">
                </div>
                <div class="form-group">
                    <label for="departamento">Departamento *</label>
                    <input type="text" id="departamento" placeholder="Ej: Recursos Humanos" required maxlength="200">
                </div>
            </div>

            <div class="form-actions">
                <button type="submit" class="btn btn-primary" id="btn-submit">
                    <span id="btn-text">üíæ Guardar Empleado</span>
                </button>
                <button type="button" class="btn btn-secondary" id="btn-cancel" onclick="cancelarEdicion()">
                    ‚ùå Cancelar
                </button>
            </div>
        </form>
    </div>

    <!-- Barra de B√∫squeda -->
    <div class="search-bar">
        <input type="text" id="search-input" placeholder="üîç Buscar empleados por nombre...">
        <button class="btn btn-info" onclick="buscarEmpleados()">Buscar</button>
        <button class="btn btn-secondary" onclick="cargarEmpleados()">Mostrar Todos</button>
    </div>

    <!-- Lista de Empleados -->
    <div class="card">
        <h2>üë• Lista de Empleados</h2>
        <div id="loading" class="loading" style="display: none;">Cargando empleados...</div>
        <div id="error-message" class="error-message" style="display: none;"></div>
        <div id="empleados-container">
            <!-- El contenido se cargar√° aqu√≠ -->
        </div>
    </div>
</div>

<!-- Modal de Confirmaci√≥n -->
<div id="modal-confirmacion" class="modal">
    <div class="modal-content">
        <h3>‚ö†Ô∏è Confirmar Eliminaci√≥n</h3>
        <p>¬øEst√°s seguro de que deseas eliminar a este empleado?</p>
        <div class="modal-actions">
            <button class="btn btn-danger" onclick="confirmarEliminar()">S√≠, Eliminar</button>
            <button class="btn btn-secondary" onclick="cerrarModal()">Cancelar</button>
        </div>
    </div>
</div>

<script src="app.js"></script>
</body>
</html>
